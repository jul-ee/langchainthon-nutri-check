```
2025.07.03 v1_README.md 작성 중
```

## 💊 영양제 Check!

**“오늘도 무슨 영양제를 먹어야 하나?”**

넘쳐나는 광고와 정보 속에서 소비자는 자신의 건강 상태와 복용 이력까지 고려한 믿을 만한 권장량·금기 성분을 알기 어렵습니다.

**영양제 Check!** 는 사용자가 간단히 “나이·성별 / 질환·증상 / 현재 복용 중인 약제 / 원하는 효과” 4가지만 입력하면

1. 학술 논문·식약처 가이드라인이 담긴 PDF를 검색해 근거 기반으로 “추천 / 피해야 할” 성분을 JSON 으로 명확히 제시하고
2. 식약처 공공데이터 1 만 건에서 해당 성분을 포함하는 실제 제품을 찾아 보여 줍니다.

> +) 사용 API & 기술 스택

> +) 시연 영상

<br>
<br>

## 👥 팀원 소개


<br>
<br>

## 프로젝트 목표

1. **정보 신뢰도**
    - LLM 답변이 임의로 성분을 “창작”하지 않도록, **선행 연구·정부 지침**이 포함된 PDF 근거만 이용 → 출처를 그대로 반환
2. **개인 맞춤**
    - 생활 습관·특정 질환 등 상호배타적 케이스(case A~D)를 미리 정의, 사용자의 라이프스타일을 분류해 처방을 다르게 제시
3. **실행 가능성**
    - “성분” 정보만으로 끝나지 않고, 식약처 OpenAPI에 등록된 실제 제품을 바로 추천해 구매·상담으로 이어질 수 있게 함

<br>
<br>

## 프로젝트 프로세스

>+) RAG 구조

1. **사용자 입력**
    
    > 나이·성별 / 질환·증상·특이사항 / 복용 중인 영양제·약품 / 원하는 영양제 특징
    > 
2. **카테고리 분류** *(흡연·운동 등 키워드 → case A~D)*
3. **근거 문헌 검색 & LLM 분석**
    - 선택된 카테고리의 PDF > 문단 단위로 벡터화 > RAG
    - 프롬프트로 허용된 성분만 사용, 답변은 순수 JSON으로 제한
4. **제품 추천**
    - JSON 의 “recommended” 성분 → FAISS(식약처 10 k) 유사도 검색
    - “avoid” 성분이 포함된 제품은 실시간 필터링
5. **Streamlit UI 출력**
    - 대화형 카드로 추천·금기·주의·출처, 최종적으로 맞춤 영양제 제품 5종 제시

<br>
<br>

## 주요 로직 & 설계 의도

#### 1. 근거 없는 LLM 환각 차단

- **RAG + 화이트리스트 프롬프트**
    
    검색된 문헌(학술 PDF·식약처 자료)만 LLM 컨텍스트로 주입하고, 답변에 쓸 수 있는 성분을 화이트리스트로 제한
    
    → “상상 속 성분”이 등장할 여지를 원천 봉쇄
    

#### 2. 사용자 상황별 케이스 분류 → 맞춤 처방

- `categorize_user_query()`에서 사용자 입력 키워드를 감지해 case A~D를 중첩 선택
- 프롬프트는 각 case의 JSON 템플릿을 그대로 이용하므로, 한 질문에 라이프스타일이 섞여도 처방이 정확히 달라짐

#### 3. 공공데이터 1,000 → 10,000 건 확장

| 단계 | 시행착오 & 해결책 |
| --- | --- |
| ① 빠른 프로토타입: 1,000건 | - 식약처 API는 `numOfRows=100`이 최대. 5페이지(=500개)를 두 번 호출해 1,000개를 수집<br>- 1 000개를 한꺼번에 임베딩했더니 “토큰 초과 오류” 발생 |
| ② 토큰 초과 우회: 500 + 500 전략 | - 먼저 500개를 임베딩해 FAISS 초기 DB를 생성<br>- 이후 500개씩 추가 수집 → 100개 단위로 쪼개 임베딩 → DB에 `add_documents()` 로 누적 |
| ③ 전면 확장: 10 000건 | - 전체 100 페이지 × 100행 = 10 000건을 500개씩(5 페이지) 반복 수집<br>- 각 500개 블록을 다시 100개 단위로 분할 임베딩 후 DB에 추가<br>- 결과: 토큰 초과 없이 약 10 K 건 벡터 DB 완성, 쿼리 속도 ↓, 커버리지 ↑ |
| ④ 필요한 정보만 LangChain Document 변환 | 업체명·기능성·주의사항·섭취방법·표준성분만 필드로 남겨 임베딩 부담 최소화 |

#### 4. 다중 PDF + 대화 맥락 유지

- 카테고리별 벡터 DB를 `EnsembleRetriever` 로 묶어 recall을 높였고,
- `history-aware retriever`가 직전 대화를 재구성하여 “대화 흐름” 을 놓치지 않음

#### 5. JSON 파싱 안전 장치

- “마크다운 금지, JSON only” 를 프롬프트에서 엄격히 요구
- `json.loads()` 실패 시 Streamlit이 즉시 경고해 UX 단절을 방지

#### 6. 실제 제품 연결 & 금기 성분 필터

- 추천 성분 → 10 K 벡터 DB 유사도 검색 → 피해야 할 성분이 포함된 제품은 실시간 제외
- 최종 5개만 노출해 사용자가 바로 비교·상담·구매로 이어지도록 설계

#### 7. 접근성 좋은 사용자 경험

- Streamlit form + chat + expander UI로, 입력 → 대답 → 근거 출처 → 제품 추천까지 한 화면에 제공
- 면책 고지도 하단에 상시 노출해 의료적 혼동을 최소화함

<br>

> **결과 및 사용자 인사이트** 는 모델·UI 개선이 완료되는 대로 업데이트될 예정입니다.
